var TextTruncation=function(){"use strict";class e{constructor(t,n={}){this.options=Object.assign({},{appendix:"â€¦",className:null},n),this.element=t,this.originalHtml=this.element.innerHTML,this.containerEdge=e.getContainerEdge(this.element),this.truncateElements=this.getTruncateElements(this.element),this.truncateElements[0].getBoundingClientRect().bottom>this.containerEdge&&(this.currentElementWidth=this.element.offsetWidth,this.truncateElement()),this.addWindowResizeListener()}static selectText(e,t,n){e.setStart(t,n-1),e.setEnd(t,n)}static deleteNode(e,t){e.selectNode(t),e.deleteContents()}static getContainerEdge(e){return e.getBoundingClientRect().bottom}static getTextNodesTree(e){return document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1)}static getElementNodesTree(e){return document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1)}static cleanUp(t){const n=e.getElementNodesTree(t),i=[];let s;for(;s=n.nextNode();)0===s.textContent.length&&i.push(s);i.forEach(e=>e.remove())}getTruncateElements(e){let t;return t=this.options.className?e.querySelectorAll(`.${this.options.className}`):e.children,Array.from(t).reverse()}addWindowResizeListener(){window.addEventListener("resize",this.onWindowResize.bind(this))}onWindowResize(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{clearTimeout(this.resizeTimeout);const t=this.element.offsetWidth;t!==this.currentElementWidth&&(t>this.currentElementWidth&&(this.element.innerHTML=this.originalHtml,this.truncateElements=this.getTruncateElements(this.element)),this.containerEdge=e.getContainerEdge(this.element),this.truncateElement(),this.currentElementWidth=this.element.offsetWidth)},100)}truncateElement(){(function t(n){const i=this.truncateElements[n],{top:s,bottom:l}=i.getBoundingClientRect();if(s>this.containerEdge)i.remove(),this.truncateElements.shift(),t.call(this,n);else if(l>this.containerEdge){const s=document.createRange(),l=e.getTextNodesTree(i),o=[];let r,c;for(;c=l.nextNode();)o.push(c);(function t(n){const i=o[n],l=i.length;r=0,e.selectText(s,i,l);const c=s.getClientRects();if(0===c.length)e.deleteNode(s,i),n>0&&t.call(this,n-1);else if(c[0]&&this.containerEdge<c[0].bottom){let o=l-r;for(;s.getClientRects().length&&s.getClientRects()[0].bottom>this.containerEdge&&s.endOffset>0||0===s.getClientRects().length&&o>0;)0===(o=l-r)||1===o&&0===i.nodeValue.indexOf(" ")?(e.deleteNode(s,i),n>0&&t.call(this,n-1)):(e.selectText(s,i,o),r++)}}).bind(this)(o.length-1);const{nodeValue:a}=s.startContainer;a&&a.length>r?s.startContainer.nodeValue=`${a.slice(0,a.length-r-3)}${this.options.appendix}`:t.call(this,n+1)}e.cleanUp(i)}).bind(this)(0)}}return e}();
